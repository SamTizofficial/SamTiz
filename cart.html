
<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>سلة المشتريات</title>

<style>
body { font-family: Arial; background:#f5f5f5; margin:0; direction:rtl; }
header { background:#000; color:#fff; padding:15px; text-align:center; }
.cart-item { background:#fff; margin:15px; padding:15px; border-radius:10px; display:flex; justify-content:space-between; align-items:center; }
button { background:#000; color:#fff; border:none; padding:5px 10px; border-radius:5px; margin-left:5px; cursor:pointer; }
form { background:#fff; margin:15px; padding:15px; border-radius:10px; }
input { width:100%; padding:8px; margin:8px 0; }
#totalInfo { background:#fff; margin:15px; padding:15px; border-radius:10px; }
</style>

<script>
let cart = JSON.parse(localStorage.getItem("cart") || "[]");

function removeItem(index){
  cart.splice(index,1);
  localStorage.setItem("cart", JSON.stringify(cart));
  location.reload();
}

function increaseQty(index){
  cart[index].qty += 1;
  localStorage.setItem("cart", JSON.stringify(cart));
  location.reload();
}

function decreaseQty(index){
  if(cart[index].qty > 1){
    cart[index].qty -= 1;
  }else{
    removeItem(index);
  }
  localStorage.setItem("cart", JSON.stringify(cart));
  location.reload();
}

function getTotalPrice(){
  return cart.reduce((acc, item) => {
    let price = parseInt(item.price.replace(/[^0-9]/g,''));
    return acc + price * item.qty;
  }, 0);
}
</script>
</head>
<body>

<header>
  <h1>سلة المشتريات</h1>
</header>

<div id="cartItems">
  <script>
  if(cart.length===0){
    document.write("<p>السلة فارغة</p>");
  } else {
    cart.forEach((item,index)=>{
      document.write(`
        <div class="cart-item">
          <span>${item.name} - ${item.price} x${item.qty}</span>
          <div>
            <button onclick="increaseQty(${index})">+</button>
            <button onclick="decreaseQty(${index})">-</button>
            <button onclick="removeItem(${index})">إزالة</button>
          </div>
        </div>
      `);
    });
  }
  </script>
</div>

<div id="totalInfo">
  <p>المجموع الكلي: <span id="totalPrice"></span> MAD</p>
  <p>طريقة الدفع: الدفع عند الاستلام</p>
</div>

<script>
document.getElementById("totalPrice").textContent = getTotalPrice();
</script>

<form action="mailto:chat.gpat153@gmail.com" method="post" enctype="text/plain">
  <h3>معلومات الطلب</h3>
  <input type="text" name="First Name" placeholder="الاسم الشخصي" required>
  <input type="text" name="Last Name" placeholder="الاسم العائلي" required>
  <input type="tel" name="Phone" placeholder="رقم الهاتف" required>
  <input type="email" name="Email" placeholder="البريد الإلكتروني (اختياري)">
  <input type="hidden" name="Products" value="">
  <button type="submit" onclick="this.form.Products.value = cart.map(i=>i.name+' x'+i.qty).join(', ')">إرسال الطلب</button>
</form>

</body>
</html>
